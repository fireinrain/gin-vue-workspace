package cfscan

import (
	"fmt"
	"testing"
)

func TestGetCIDRByASN(t *testing.T) {
	asn, err := GetCIDRByASN("AS906")
	if err != nil {
		fmt.Println(err.Error())
	}
	fmt.Println(asn)
}

func TestGetCIDRByASN2File(t *testing.T) {
	GetCIDRByASN2File("AS906", "asn906.txt")
}

func TestExtractIPv4Addresses(t *testing.T) {
	text := "这是一些 IPv4 地址的例子: 192.168.0.1 是局域网地址, 8.8.8.8 是 Google 的 DNS, 255.255.255.255 是广播地址. 172.16.0.0 到 172.31.255.255 是私有地址范围."

	ipAddresses := ExtractIPv4Addresses(text)
	fmt.Println(ipAddresses)

}

func TestExtractIPv4CIDRAddresses(t *testing.T) {
	// 测试字符串
	text := "这是一些 IPv4 CIDR 地址的例子: 192.168.0.0/24 是常见的局域网地址, 10.0.0.0/8 是私有地址范围, 172.16.0.0/12 也是私有地址. 公网地址如 8.8.8.8/32 (单个IP) 和 203.0.113.0/24 也很常见."

	cidrAddresses := ExtractIPv4CIDRAddresses(text)

	fmt.Println("找到的 IPv4 CIDR 地址:")
	for _, cidr := range cidrAddresses {
		fmt.Println(cidr)
	}
}

func TestSplitCIDRs(t *testing.T) {
	cidr := []string{
		"45.59.184.0/24",
		"45.59.185.0/24",
		"45.59.186.0/24",
		"45.59.187.0/24",
		"65.75.192.0/24",
		"65.75.193.0/24",
		"65.75.194.0/24",
		"65.75.195.0/24",
		"103.117.100.0/24",
		"103.117.101.0/24",
		"103.117.102.0/24",
		"103.117.103.0/24",
		"103.135.248.0/24",
		"103.135.249.0/24",
		"136.175.176.0/24",
		"136.175.177.0/24",
		"136.175.178.0/24",
		"136.175.179.0/24",
		"154.3.32.0/24",
		"154.3.33.0/24",
		"154.3.34.0/24",
		"154.3.35.0/24",
		"154.3.36.0/24",
		"154.3.37.0/24",
		"154.3.38.0/24",
		"154.3.39.0/24",
		"154.12.176.0/24",
		"154.12.177.0/24",
		"154.12.178.0/24",
		"154.12.179.0/24",
		"154.12.188.0/24",
		"154.12.189.0/24",
		"154.12.190.0/24",
		"154.12.191.0/24",
		"154.17.0.0/24",
		"154.17.1.0/24",
		"154.17.2.0/24",
		"154.17.3.0/24",
		"154.17.4.0/24",
		"154.17.5.0/24",
		"154.17.6.0/24",
		"154.17.7.0/24",
		"154.17.8.0/24",
		"154.17.9.0/24",
		"154.17.10.0/24",
		"154.17.11.0/24",
		"154.17.12.0/24",
		"154.17.13.0/24",
		"154.17.14.0/24",
		"154.17.15.0/24",
		"154.17.16.0/24",
		"154.17.17.0/24",
		"154.17.18.0/24",
		"154.17.19.0/24",
		"154.17.20.0/24",
		"154.17.21.0/24",
		"154.17.22.0/24",
		"154.17.23.0/24",
		"154.17.24.0/24",
		"154.17.25.0/24",
		"154.17.26.0/24",
		"154.17.27.0/24",
		"154.17.28.0/24",
		"154.17.29.0/24",
		"154.17.30.0/24",
		"154.17.31.0/24",
		"154.17.224.0/24",
		"154.17.225.0/24",
		"154.17.226.0/24",
		"154.17.227.0/24",
		"154.17.228.0/24",
		"154.17.229.0/24",
		"154.17.230.0/24",
		"154.17.231.0/24",
		"154.17.233.0/24",
		"154.21.80.0/24",
		"154.21.81.0/24",
		"154.21.82.0/24",
		"154.21.83.0/24",
		"154.21.84.0/24",
		"154.21.85.0/24",
		"154.21.86.0/24",
		"154.21.87.0/24",
		"154.21.88.0/24",
		"154.21.89.0/24",
		"154.21.90.0/24",
		"154.21.91.0/24",
		"154.21.92.0/24",
		"154.21.93.0/24",
		"154.21.94.0/24",
		"154.21.95.0/24",
		"154.31.112.0/24",
		"154.31.113.0/24",
		"154.31.114.0/24",
		"154.31.115.0/24",
		"154.31.116.0/24",
		"154.31.117.0/24",
		"154.31.118.0/24",
		"154.31.119.0/24",
		"174.136.204.0/24",
		"174.136.205.0/24",
		"174.136.206.0/24",
		"174.136.207.0/24",
		"193.110.200.0/22",
		"199.189.152.0/24",
		"199.189.153.0/24",
		"199.189.154.0/24",
		"199.189.155.0/24",
		"23.67.62.0/24",
		"27.109.128.0/19",
		"27.109.128.0/18",
		"27.109.128.0/17",
		"27.109.160.0/19",
		"27.109.192.0/19",
		"27.109.192.0/18",
		"27.109.224.0/19",
		"43.249.215.0/24",
		"45.64.20.0/24",
		"45.64.20.0/22",
		"45.64.21.0/24",
		"60.246.0.0/19",
		"60.246.0.0/18",
		"60.246.0.0/17",
		"60.246.0.0/16",
		"60.246.32.0/19",
		"60.246.64.0/19",
		"60.246.64.0/18",
		"60.246.96.0/19",
		"60.246.128.0/19",
		"60.246.128.0/18",
		"60.246.128.0/17",
		"60.246.160.0/19",
		"60.246.192.0/19",
		"60.246.192.0/18",
		"60.246.224.0/19",
		"103.233.188.0/22",
		"104.77.80.0/24",
		"113.52.64.0/19",
		"113.52.64.0/18",
		"113.52.96.0/19",
		"122.100.128.0/19",
		"122.100.128.0/18",
		"122.100.128.0/17",
		"122.100.160.0/19",
		"122.100.192.0/19",
		"122.100.192.0/18",
		"122.100.224.0/19",
		"122.100.248.0/24",
		"122.100.248.0/21",
		"122.100.249.0/24",
		"122.100.250.0/24",
		"122.100.251.0/24",
		"122.100.252.0/24",
		"122.100.253.0/24",
		"122.100.254.0/24",
		"122.100.255.0/24",
		"125.31.0.0/19",
		"125.31.0.0/18",
		"125.31.22.0/24",
		"125.31.23.0/24",
		"125.31.32.0/19",
		"125.31.55.0/24",
		"180.94.128.0/19",
		"180.94.128.0/18",
		"180.94.160.0/19",
		"182.93.0.0/19",
		"182.93.0.0/18",
		"182.93.32.0/19",
		"202.86.128.0/19",
		"202.86.128.0/18",
		"202.86.160.0/19",
		"202.86.162.0/24",
		"202.174.0.0/22",
		"202.175.0.0/19",
		"202.175.0.0/18",
		"202.175.0.0/17",
		"202.175.5.0/24",
		"202.175.32.0/19",
		"202.175.64.0/19",
		"202.175.64.0/18",
		"202.175.67.0/24",
		"202.175.96.0/19",
		"202.175.160.0/24",
		"202.175.160.0/19",
		"205.215.0.0/19",
	}
	rs := SplitCIDRs(cidr, 100000)
	println(len(rs))
}
